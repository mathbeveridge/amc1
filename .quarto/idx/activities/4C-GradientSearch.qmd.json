{"title":"5.C Gradient Search","markdown":{"headingText":"5.C Gradient Search","containsRefs":false,"markdown":"\n```{r, echo=FALSE, results=\"hide\", warning=FALSE, message=FALSE}\n# Load packages\nlibrary(mosaic)\nlibrary(mosaicCore)\nlibrary(mosaicCalc)\n```\n\n## Rundown\n\n::: {.callout-note title=\"Learning goals\"}\n-   Find a local maximum of a 2D function $f(x,y)$ using gradient search in *RStudio*.\n-   Find a local minimum of a 2D function $f(x,y)$ using gradient search in *RStudio*.\n-   Simulate gradient search using the contour plot of a 2D function to find the trajectory that gradient search follows to reach an extreme point.\n-   Explain why the extreme point found by gradient search depends upon the starting point that we use.\n:::\n\n### Gradient Search Example\n\nLet's use gradient search to find the maximum of the function $$\nf(x,y) = - x^4 -  x^3 + 10 x y + 2y - 8 y^2 \n$$ whose partial derivatives are $$\n\\frac{\\partial f}{\\partial x} = -4 x^3 -3 x^2  + 10 y\n\\quad \\mbox{and} \\quad\n\\frac{\\partial f}{\\partial x} = 10 x + 2 - 16 y\n$$\n\nFirst, you define the partial derivatives and then choose your starting point `(newx, newy)`. In this case, we start at `(1,1)`.\n\n\\\n\\\n\n```{r}\npartialx = makeFun( -4*x^3 -3*x^2 + 10*y ~ x&y)\npartialy = makeFun(10*x + 2 - 16*y ~ x&y)\nnewx = 1\nnewy = 1\n```\n\n\\\n\\\n\nNext, you **repeatedly** run the following code block, which updates the current point by moving `0.1` times the gradient vector. This takes a small step in the uphill direction.\n\n```{r eval=FALSE}\nslopex=partialx(newx, newy)\nslopey=partialy(newx, newy)\nnewx = newx + 0.05*slopex\nnewy = newy + 0.05*slopey\n# print new partial derivatives\nc(partialx(newx, newy), partialy(newx, newy))\n# print new point\nc(newx, newy)\n```\n\nRepeatedly run this code block until the partial derivatives are essentially zero (at least two zeros after the decimal point). Congrats! You have found your local maximum.\n\nYou will end at the point `(1.04,0.77)`. But note that starting at another initial point might take you to a different local maximum!\n\nYou can check that this critical point is a local maximum (and not a saddle point) by using the same method that we used for 2D Optimizatiion\n\n```{r}\nf = makeFun( -x^4 - x^3 + 10*x*y + 2* y - 8* y^2 ~ x&y)\na=1.0405\nb=0.7753\nr = 0.1\ntheta = seq(0,2*pi,pi/10)\nf(a,b) - f(a+r*cos(theta), b+r*sin(theta))\n```\n\n## Activities\n\n### Finding a Local Minimum\n\n1.  How should I change to the code if I want to find a **local minimum** instead of a local maximum? (Hint: we want to take a small step downhill.)\n2.  Use gradient search to find a **local minimum** of $$f(x,y) = x^2 + 2 x y + 3 x + 4 y + 5 y^2.$$\n\n## Solutions\n\n<details>\n\n<summary>Click for Solutions</summary>\n\n### Finding a Local Minimum\n\n1.  In order to find a local minimum, we need to move in the opposite direction of the gradient. This is the \"downhill direction.\" All we need to do in the code is replace the two `+ 0.1` with `- 0.1`.\n\n2.  We want to find the local minimum of $$f(x,y) = x^2 + 2 x y + 3 x + 4 y + 5 y^2.$$ We have $$\n    f_x(x,y) = 2x +2y + 3, \\qquad f_y(x,y) = 2x + 4 + 10y.\n    $$ Here is our updated code to walk downhill. We set up our partials and pick our starting point.\n\n```{r}\npartialx = makeFun(2*x +2*y + 3 ~ x&y)\npartialy = makeFun(2*x + 4 + 10*y ~ x&y)\nnewx = 1\nnewy = 1\n```\n\nNow we repeatedly run this \"move downhill\" block until the partial derivatives are (basically) zero.\n\n```{r }\nslopex=partialx(newx, newy)\nslopey=partialy(newx, newy)\nnewx = newx - 0.05*slopex\nnewy = newy - 0.05*slopey\n# print new partial derivatives\nc(partialx(newx, newy), partialy(newx, newy))\n# print new point\nc(newx, newy)\n```\n\nIf we run this 20 or 30 times, the partial derivatives become zero, and we estimate our local minimum to be the point $(-1.37, -0.13)$.\n\n</details>\n","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"4C-GradientSearch.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","editor":"visual","theme":"united","code-copy":true,"grid":{"sidebar-width":"200px","body-width":"1000px","margin-width":"150px"}},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}