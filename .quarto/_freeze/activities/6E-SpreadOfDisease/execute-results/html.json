{
  "hash": "7907634fc03a0c1ac07c230da5213f2e",
  "result": {
    "engine": "knitr",
    "markdown": "# SIR Model\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\n## Rundown\n\n::: {.callout-note title=\"Learning goals\"}\n-   Describe the Susceptible-Infected-Removed model for the spread of disease.\n-   Explain the various terms in the differential equations of the SIR model.\n-   Define the infection rate $a$ and the removal rate $b$.\n-   Create an SIR slope field using RStudio, and interpret what I see.\n-   Create an SIR trajectory plot using RStudio, and interpret what I see.\n-   Explain what the epidemic phase of a disease outbreak is\n-   Identify the threshold population by looking at an SIR slope field, looking at an SIR trajectory, or calculating $b/a$ in the SIR differential equations\n-   Describe the effect of various actions to mitigate the spread of disease, and how that changes the SIR Model.\n:::\n\n### The SIR Model for the Spread of Disease\n\nIn the SIR Model the population is partitioned into three categories: Susceptible, Infected and Removed (or Recovered). There are two parameters:\n\n-   The infection rate $a$\n-   The removal rate $b$\n\nHere are the three differential equations that make up the SIR Model\n\n\\begin{align}\n\\frac{dS}{dt} &= -a \\,S\\, I \\\\\n\\frac{dI}{dt} &= a \\, S\\, I - b  \\, I \\\\\n\\frac{dR}{dt} &=  b  \\, I\n\\end{align}\n\n#### Plotting an SIR Slope Field and an SIR Trajectory\n\nThe `mosaicCalc` package has a `vectorfield_plot` function that we use to create a slope field, and a `traj_plot` function that we use to plot a trajectory. So we need to make sure that this package has been loaded into RStudio.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsuppressPackageStartupMessages(library(mosaicCalc))\n```\n:::\n\n\n\n\nHere is some example code that plots an SIR slope field where\n\n-   The infection rate is $a=0.001$\n-   The removal rate is $b=0.2$\n-   $0 \\leq S \\leq 800$\n-   $0 \\leq I \\leq 100$\n\nThe horizontal axis is the susceptible population and the vertical axis is the infected population.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvectorfield_plot(S ~ - 0.001*S*I, \n                 I ~ 0.001*S*I -0.2*I, \n                 domain(S=0:800, I=0:100), \n                 transform=function(L) L^0.01)\n```\n:::\n\n\n\n\nHere is some example code that plots a single SIR trajectory for this same model. Here are the additional inputs:\n\n-   `domain(t=0:80)` means that the trajectory runs for $0 \\leq t \\leq 80$.\n-   `S=800` means that the initial susceptible population is 800.\n-   `I=5` means that the initial infected population is 5.\n-   `nt=20` means that 20 tick marks will be added to the trajectory, showing the time that the point $(S,I)$ occurs.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSIRdyn = makeODE(dS ~ - 0.001*S*I, \n                  dI ~  0.001*S*I -0.2*I )\nSoln = integrateODE(SIRdyn, domain(t=0:80), S=800, I=5)\ntraj_plot(I(t) ~ S(t), Soln, nt=20)\n```\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n\n```\nSolution containing functions S(t), I(t).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](6E-SpreadOfDisease_files/figure-html/unnamed-chunk-5-1.png){width=70%}\n:::\n:::\n\n\n\n\n## Activities\n\n### Threshold Population for an SIR Model\n\nHere is the slope field for an SIR Model. The horizontal axis is the Susceptible population and the vertical axis is the Infected population.\n\n1.  If we start at $S=200$ and $I=30$, are we in epidemic phase?\n2.  If we start at $S=400$ and $I=10$, are we in epidemic phase?\n3.  What is the threshold population for this SIR Model?\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](6E-SpreadOfDisease_files/figure-html/unnamed-chunk-6-1.png){width=70%}\n:::\n:::\n\n\n\n\n### Ending an Outbreak Before Everyone Gets Sick\n\nA disease is spreading according to the SIR Model $$\n\\frac{dS}{dt} = -0.001 SI \\qquad  \\frac{dS}{dt} = 0.001 SI -0.2 I \n$$ 1. Use `traj_plot` to create the SI trajectory for initial conditions $S=600$ and $I=8$. Start with $0 \\leq t \\leq 100.$ 2. How long does the outbreak last? Answer this question by lowering the upper bound on $t$ to find the first time where $I=0$. 3. Now increase the removal rate $b=0.2$ to find the smallest value of $b$ such that when the outbreak is over, there are at least 200 susceptible people who never became infected. Your answer should be correct up to two decimal places.\n\n\n\n\n````{=html}\n<!--\n::: {.cell}\n\n```{.r .cell-code}\nSIRdyn = makeODE(dS ~ - 0.001*S*I, \n                  dI ~  0.001*S*I -.38*I )\nSoln = integrateODE(SIRdyn, domain(t=0:45), S=600, I=8)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nSolution containing functions S(t), I(t).\n```\n\n\n:::\n\n```{.r .cell-code}\ntraj_plot(I(t) ~ S(t), Soln, nt=20)\n```\n\n::: {.cell-output-display}\n![](6E-SpreadOfDisease_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n-->\n````\n\n\n\n\n### Managing an Outbreak\n\nThe peak Infected population always occurs at the *threshold population* $$\nS = \\frac{b}{a}.\n$$ If $S > b/a$ then the infected population is increasing, and we are in *epidemic phase.*\n\nWhat are some strategies for getting out of epidemic phase? What effect do these strategies have on the parameters our S-I-R Model? Does this action change the infection rate $a$? Change the removal rate $b$? Or something else?\n\n### Changing Infection Rate Versus Changing Removal Rate\n\n1.  Use `traj_plot` to create a trajectory for the SIR Model $$\n    \\frac{dS}{dt} = -0.001 SI \\qquad  \\frac{dS}{dt} = 0.001 SI -0.2 I \n    $$ starting at $S=600$ and $I=8$ and $0 \\leq t \\leq 50$. How large is the peak infected population? When does it occur? How many uninfected people are there at the end of the outbreak?\n\n2.  Now let's change the model to be half as infectious: $$\n    \\frac{dS}{dt} = -0.0005 SI \\qquad  \\frac{dS}{dt} = 0.0005 SI -0.2 I \n    $$ and starting at $S=600$ and $I=8$. Plot this trajectory. How large is the peak infected population? When does it occur? How many uninfected people are there at the end of the outbreak? How long does the outbreak last?\n\n3.  Now let's change the original model by doubling the removal time: $$\n    \\frac{dS}{dt} = -0.001 SI \\qquad  \\frac{dS}{dt} = 0.001 SI -0.4 I \n    $$ and starting at $S=600$ and $I=8$. Plot this trajectory. How large is the peak infected population? When does it occur? How many uninfected people are there at the end of the outbreak? How long does the outbreak last?\n\n4.  Compare your answers to part 2 and part 3. What do you notice?\n\n\\\n\\\n\\\n\\\n\n## Solutions\n\n<details>\n\n<summary>Click for Solutions</summary>\n\n### Threshold Population for an SIR Model\n\nHere is the slope field for an SIR Model. The horizontal axis is the Susceptible population and the vertical axis is the Infected population.\n\n1.  No, we are not in epidemic phase. The number of infecteds is decreasing when $S=200$.\n2.  Yes, we are in epidemic phase. The number of infecteds is increasing when $S=400$.\n3.  The threshold population is $$ \\frac{b}{a} = \\frac{0.5}{0.002}=250.$$\n\n### Ending an Outbreak Before Everyone Gets Sick\n\nA disease is spreading according to the SIR Model $$\n\\frac{dS}{dt} = -0.001 SI \\qquad  \\frac{dS}{dt} = 0.001 SI -0.2 I \n$$ 1. Use `traj_plot` to create the SI trajectory for initial conditions $S=600$ and $I=8$. Start with $0 \\leq t \\leq 100.$\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSIRdyn = makeODE(dS ~ - 0.001*S*I, \n                  dI ~  0.001*S*I - 0.2*I )\nSoln = integrateODE(SIRdyn, domain(t=0:100), S=600, I=8)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nSolution containing functions S(t), I(t).\n```\n\n\n:::\n\n```{.r .cell-code}\ntraj_plot(I(t) ~ S(t), Soln, nt=20)\n```\n\n::: {.cell-output-display}\n![](6E-SpreadOfDisease_files/figure-html/unnamed-chunk-8-1.png){width=70%}\n:::\n:::\n\n\n\n\n2.  The outbreak lasts about 50 days.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSIRdyn = makeODE(dS ~ - 0.001*S*I, \n                  dI ~  0.001*S*I - 0.2*I )\nSoln = integrateODE(SIRdyn, domain(t=0:50), S=600, I=8)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nSolution containing functions S(t), I(t).\n```\n\n\n:::\n\n```{.r .cell-code}\ntraj_plot(I(t) ~ S(t), Soln, nt=10)\n```\n\n::: {.cell-output-display}\n![](6E-SpreadOfDisease_files/figure-html/unnamed-chunk-9-1.png){width=70%}\n:::\n:::\n\n\n\n\n3.  The removal rate $b=0.38$ is the smallest rate that has at least 200 susceptible people remaining when the infected population is 0.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSIRdyn = makeODE(dS ~ - 0.001*S*I, \n                  dI ~  0.001*S*I - 0.38*I )\nSoln = integrateODE(SIRdyn, domain(t=0:50), S=600, I=8)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nSolution containing functions S(t), I(t).\n```\n\n\n:::\n\n```{.r .cell-code}\ntraj_plot(I(t) ~ S(t), Soln, nt=20)\n```\n\n::: {.cell-output-display}\n![](6E-SpreadOfDisease_files/figure-html/unnamed-chunk-10-1.png){width=70%}\n:::\n:::\n\n\n\n\n### Managing an Outbreak\n\nReality is complicated, and many of these actions have diverse impacts. So there is not a single \"right answer\" here. But here are a few actions and their potential impacts on the SIR Model.\n\nThe following actions reduce the infection rate $a$\n\n-   Social distancing (fewer and less frequent interactions)\n-   Masking (harder to transmit)\n-   Hand washing, sanitizing (harder to transmit)\n\nThe following actions increase the removal rate $b$\n\n-   Isolating of infected people (isolation places an infected person into the removed category)\n-   Testing and isolating of people who test positive (same as above)\n-   Theraputic drugs that help you to recover more quickly\n\nAn effective vaccine moves people directly from susceptible to removed. This adds a new term, based on the vaccination rate. For example: $$\n\\frac{dS}{dt} = -aSI - cS, \\qquad \\frac{dI}{dt} = aSI - bI, \\qquad \\frac{dR}{dt} = bI + cS,\n$$ where $0 < c < 1$ is the rate at which susceptible people are vaccinated.\n\n### Changing Infection Rate Versus Changing Removal Rate\n\n1.  The peak infected population is about 185. It occurs at $t=12.5$. There are about 25 susceptible people left at the end of the outbreak.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSIRdyn = makeODE(dS ~ - 0.001*S*I, \n                  dI ~  0.001*S*I -.2*I )\nSoln = integrateODE(SIRdyn, domain(t=0:50), S=600, I=8)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nSolution containing functions S(t), I(t).\n```\n\n\n:::\n\n```{.r .cell-code}\ntraj_plot(I(t) ~ S(t), Soln, nt=20)\n```\n\n::: {.cell-output-display}\n![](6E-SpreadOfDisease_files/figure-html/unnamed-chunk-11-1.png){width=70%}\n:::\n:::\n\n\n\n\n2.  When the model is half as infectious, the peak infected population is 46, and this occurs at $t=29$. There are about 235 susceptible people left at the end of the outbreak, which lasts about 100 days.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSIRdyn = makeODE(dS ~ - 0.0005*S*I, \n                  dI ~  0.0005*S*I -.2*I )\nSoln = integrateODE(SIRdyn, domain(t=0:100), S=600, I=8)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nSolution containing functions S(t), I(t).\n```\n\n\n:::\n\n```{.r .cell-code}\ntraj_plot(I(t) ~ S(t), Soln, nt=20)\n```\n\n::: {.cell-output-display}\n![](6E-SpreadOfDisease_files/figure-html/unnamed-chunk-12-1.png){width=70%}\n:::\n:::\n\n\n\n\n3.  When the removal time is doubled, the peak infected population is 46, and this occurs at $t=14.5$. There are 235 susceptible people at the end of the outbreak, which lasts 50 days.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSIRdyn = makeODE(dS ~ - 0.001*S*I, \n                  dI ~  0.001*S*I -.4*I )\nSoln = integrateODE(SIRdyn, domain(t=0:50), S=600, I=8)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nSolution containing functions S(t), I(t).\n```\n\n\n:::\n\n```{.r .cell-code}\ntraj_plot(I(t) ~ S(t), Soln, nt=20)\n```\n\n::: {.cell-output-display}\n![](6E-SpreadOfDisease_files/figure-html/unnamed-chunk-13-1.png){width=70%}\n:::\n:::\n\n\n\n\n4.  The models in parts 2 and 3 both follow the same trajectory, but the outbreak in Model 3 happens twice as quickly. The respective changes to the removal rate $a$ (in Model 2) and the removal rate $b$ (in Model 3) both have the same effect on the threshold population (which is twice its original value).\n\n</details>\n",
    "supporting": [
      "6E-SpreadOfDisease_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}