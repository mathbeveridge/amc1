{
  "hash": "196f0b65ba6a79b28b8efd297456fac9",
  "result": {
    "engine": "knitr",
    "markdown": "# 2D Optimization\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\n## Rundown\n\n::: {.callout-note title=\"Learning goals\"}\n-   Find the 2D critical points of $f(x,y)$ by (simultaneously) solving $f_x(x,y)=0$ and $f_y(x,y)=0$.\n-   Characterize a 2D critical point $(a,b)$ as a local minimimum, local maximum or saddle point by:\n    -   Looking at the values of $f(a,b)-f(x,y)$ on a small circle around $(a,b)$.\n    -   Making a contour plot near $(a,b)$\n    -   Using the 2D second derivative test at $(a,b)$\n:::\n\n### 2D Critical Points\n\nThe **critical points** of $f(x,y)$ are the points $(a,b)$ where both $f_x(a,b)=0$ and $f_y(a,b)=0$.\n\nThere are three ways to determine whether a critical point $(a,b)$ is a minimum, a maximum, or a saddle point.\n\n1.  Find the values of $f(a,b) - f(x,y)$ for points $(x,y)$ in a small circle around $(a,b)$.\n\n    -   If these values are ALL positive then $(a,b)$ is a local maximum\n    -   If these values are ALL negative then $(a,b)$ is a local minimum\n    -   If some values are positive and some values are negative, then $(a,b)$ is a saddle point.\n\n2.  Create a contour plot for $f(x,y)$ on a very small neighborhood of $(a,b)$. Use the contours to figure out whether it is a local max, a local min, or a saddle point.\n\n3.  The second derivative test relies on the value $$\n    D = f_{xx} f_{yy} - (f_{xy})^2.\n    $$\n\n    -   If $D > 0$ and $f_{xx} > 0$ then $(a,b)$ is a local minimum.\n    -   If $D > 0$ and $f_{xx} < 0$ then $(a,b)$ is a local maximum\n    -   If $D < 0$ then $(a,b)$ is a saddle point\n    -   If $D=0$ then the test fails\n\nAmong these options, #1 is the easiest to use. Here is a [link to a desmos workbook](https://www.desmos.com/calculator/hxhiomaduw) that classifies the critical point $(2,-1)$ of the function $f(x,y)= x^2+ 2y^4+ 4xy$ by creating a table of values $f(2,1) - f(c,d)$ where the points $(c,d)$ are in a small circle around $(2,1)$.\n\nHere is some R code that does the same thing.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nf = makeFun(x^2 + 2*y^4 + 4*x*y ~ x&y)\na=2\nb=-1\n\nr = 0.1\ntheta = seq(0,2*pi,pi/10)\nf(a,b) - f(a+r*cos(theta), b+r*sin(theta)) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] -0.010000000 -0.032025526 -0.065424470 -0.096866673 -0.114533357\n [6] -0.112200000 -0.091021947 -0.058824413 -0.027382209 -0.008514116\n[11] -0.010000000 -0.032497662 -0.068673667 -0.105338809 -0.128297176\n[16] -0.128200000 -0.104785766 -0.067296549 -0.030631406 -0.008986252\n[21] -0.010000000\n```\n\n\n:::\n:::\n\n\n\n\nAll of the values are negative, which means that $f(2,-1)$ is a local minimum.\n\n## Activities\n\n### Characterize the Extrema\n\nMultiple 2D functions have been (contour) plotted below. For each, identify the critical points and determine if they are maximums, minimums, or saddle points.\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nf = makeFun(x^2+y^2+3~x&y)\ncontour_plot(f(x,y)~x&y, domain(x=-2:2, y=-2:2), skip = 0)\n```\n\n::: {.cell-output-display}\n![](4B-Optimization2D_files/figure-html/unnamed-chunk-3-1.png){fig-align='center' width=672}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nf = makeFun(-x*y*exp(-x^2-y^2)~x&y)\ncontour_plot(f(x,y)~x&y, domain(x=-1.5:1.5, y=-1.5:1.5), skip = 0)\n```\n\n::: {.cell-output-display}\n![](4B-Optimization2D_files/figure-html/unnamed-chunk-4-1.png){fig-align='center' width=672}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nf = makeFun(y^2-x^2~x&y)\ncontour_plot(f(x,y)~x&y, domain(x=-2:2, y=-2:2), skip = 0)\n```\n\n::: {.cell-output-display}\n![](4B-Optimization2D_files/figure-html/unnamed-chunk-5-1.png){fig-align='center' width=672}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nf = makeFun(cos(x)*(x^2-y^2)~x&y)\ncontour_plot(f(x,y)~x&y, domain(x=-1.5:1.5, y=-1.5:1.5), skip = 1)\n```\n\n::: {.cell-output-display}\n![](4B-Optimization2D_files/figure-html/unnamed-chunk-6-1.png){fig-align='center' width=672}\n:::\n:::\n\n\n\n\n### Classifying a critical point using a small circle of values\n\nThe function $f(x,y) =3x^2y + y^3 -3x^2-3y^2+3$ has four critical points: $$\n(0,0) \\qquad (0,2) \\qquad (1,1) \\qquad (1,,-1).\n$$ For each critical point $(a,b)$, evaluate $f(a,b) - f(x,y)$ in a small circle centered at $(a,b)$ to determine whether it is a local minimum, a local maximum, or a saddle point\n\n### The 2D Second Derivative Test\n\nThe function $f(x,y)=10 + x^3 + 8y^3 - 3xy$ has two critical points: $(0,0)$ and $(1/2,1/4)$.\n\n1.  Use the second derivative test to classify each point as a local minimum, local maximum, or saddle point. For convenience, here are the second derivatives of $f(x,y)$.\n\n$$\nf_{xx} = 6x, \\qquad f_{yy} = 48y, \\qquad f_{xy} = -3.\n$$\n\n2.  Confirm that your answer is correct by creating a contour plot on a very small neighborhood around each critical point.\n\n### Classify the Critical Points\n\nFind the critical points of $f(x,y)=9-2x+4y-x^2-4y^2$. Then use any method that you like to classify each one as a local minimum, a local maximum or a saddle point.\n\n### Optimizing Flight Control\n\nThe range over which a flying drone can be guided is related to the atmospheric temperature and humidity. The range function is $$\nR(t,h)=27800-5t^2-6ht-3h^2+400t+300h\n$$ What are the optimal atmospheric conditions?\n\n\\\n\\\n\\\n\\\n\n## Solutions\n\n<details>\n\n<summary>Click for Solutions</summary>\n\n### Characterize the Extrema\n\nPlot 1 \\* Local minimum at $(0,0)$\n\nPlot 2 \\* Local minima at $(-0.75, -0.75)$ and $(0.75, 0.75)$ \\* Local maxima at $(-0.75, 0.75)$ and $(0.75, -0.75)$ \\* Saddle point at $(0,0)$\n\nPlot 3 \\* Saddle point at $(0,0)$\n\nPlot 4 \\* Local maxima at $(-1,0)$ and $(1,0)$ \\* Saddle point at $(0,0)$\n\n### Classifying a critical point using a small circle of values\n\nLet's define our function and then check each of our critical points.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nf = makeFun(3*x^2*y + y^3 -3*x^2-3*y^2+3~x&y)\n```\n:::\n\n\n\n\nFirst, we check $(0,0)$ and find that it is a **local maximum**.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\na=0\nb=0\nr = 0.1\ntheta = seq(0,2*pi,pi/10)\nf(a,b) - f(a+r*cos(theta), b+r*sin(theta))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] 0.03000000 0.02913197 0.02864279 0.02863197 0.02886731 0.02900000\n [7] 0.02886731 0.02863197 0.02864279 0.02913197 0.03000000 0.03086803\n[13] 0.03135721 0.03136803 0.03113269 0.03100000 0.03113269 0.03136803\n[19] 0.03135721 0.03086803 0.03000000\n```\n\n\n:::\n:::\n\n\n\n\nNext, we check $(0,2)$ and find that it is also a **local minimum**.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\na=0\nb=2\nr = 0.1\ntheta = seq(0,2*pi,pi/10)\nf(a,b) - f(a+r*cos(theta), b+r*sin(theta)) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] -0.03000000 -0.03086803 -0.03135721 -0.03136803 -0.03113269 -0.03100000\n [7] -0.03113269 -0.03136803 -0.03135721 -0.03086803 -0.03000000 -0.02913197\n[13] -0.02864279 -0.02863197 -0.02886731 -0.02900000 -0.02886731 -0.02863197\n[19] -0.02864279 -0.02913197 -0.03000000\n```\n\n\n:::\n:::\n\n\n\n\nNext up is $(1,1)$.It is a **saddle point**!\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\na=1\nb=1\nr = 0.1\ntheta = seq(0,2*pi,pi/10)\nf(a,b) - f(a+r*cos(theta), b+r*sin(theta)) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1]  0.00000000 -0.01850159 -0.02988890 -0.02989973 -0.01876625 -0.00100000\n [7]  0.01650087  0.02716366  0.02717449  0.01676552  0.00000000 -0.01676552\n[13] -0.02717449 -0.02716366 -0.01650087  0.00100000  0.01876625  0.02989973\n[19]  0.02988890  0.01850159  0.00000000\n```\n\n\n:::\n:::\n\n\n\n\nOne more point to go: $(1,-1)$. This is also a **saddle point**.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\na=1\nb=-1\nr = 0.1\ntheta = seq(0,2*pi,pi/10)\nf(a,b) - f(a+r*cos(theta), b+r*sin(theta)) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1]  1.2600000  0.8119458  0.2955892 -0.2353778 -0.7292137 -1.1410000\n [7] -1.4355873 -1.5889990 -1.5889882 -1.4353227 -1.1400000 -0.7272129\n[13] -0.2326526  0.2983144  0.8139466  1.2610000  1.5908545  1.7660624\n[19]  1.7660516  1.5905898  1.2600000\n```\n\n\n:::\n:::\n\n\n\n\n### The 2D Second Derivative Test\n\nThe function $f(x,y)=10 + x^3 + 8y^3 - 3xy$ has two critical points: $(0,0)$ and $(1/2,1/4)$.\n\n1.  The critical points are $(0,0)$ and $(1/2,1/4)$. The second derivatives are $$\n    f_{xx} = 6x, \\qquad f_{yy} = 48y, \\qquad f_{xy} = -3.\n    $$ so our second derivative test function is $$\n    D(x,y) = (6x)(48y) - 9.\n    $$ We have $D(0,0) = -9$ so $(0,0)$ is a saddle point. We have $D(1/2,1/4)= 3 \\cdot 12 - 99 = 36 - 9 > 0$. So we further check that $f_{xx}(1/2,1/4) = 3 > 0$ which means that \\$(1/2, 1/4) is a local minimum.\n\n2.  Here is a plot that shows that $(0,0)$ is a saddle point.\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nf = makeFun(10 + x^3 + 8*y^3 - 3*x*y~x&y)\ncontour_plot(f(x,y)~x&y, domain(x=-1:1, y=-1:1), skip=0)\n```\n\n::: {.cell-output-display}\n![](4B-Optimization2D_files/figure-html/unnamed-chunk-12-1.png){fig-align='center' width=672}\n:::\n:::\n\n\n\n\nHere is another plot that zooms in on $(1/2,1/4)$. It is clear that this is a local minimum.\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nf = makeFun(10 + x^3 + 8*y^3 - 3*x*y~x&y)\ncontour_plot(f(x,y)~x&y, domain(x=0:1, y=0:1), skip = 0)\n```\n\n::: {.cell-output-display}\n![](4B-Optimization2D_files/figure-html/unnamed-chunk-13-1.png){fig-align='center' width=672}\n:::\n:::\n\n\n\n\n### Classify the Critical Points\n\nLet's find the critical points of $f(x,y)=9-2x+4y-x^2-4y^2$. We have $$\nf_x(x,y) = -2-2x, \\qquad f_y(x,y) = 4 - 8y.\n$$\n\nThe only critical point is $(-1, 1/2)$. Let's compare $f(-1,1/2)$ to the values of $f(x,y)$ on a small circle around this point.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nf=makeFun(9 - 2*x + 4*y - x^2 - 4*y^2 ~ x&y)\na=-1\nb=1/2\nr = 0.1\ntheta = seq(0,2*pi,pi/10)\nf(a,b) - f(a+r*cos(theta), b+r*sin(theta)) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] 0.01000000 0.01286475 0.02036475 0.02963525 0.03713525 0.04000000\n [7] 0.03713525 0.02963525 0.02036475 0.01286475 0.01000000 0.01286475\n[13] 0.02036475 0.02963525 0.03713525 0.04000000 0.03713525 0.02963525\n[19] 0.02036475 0.01286475 0.01000000\n```\n\n\n:::\n:::\n\n\n\n\nThis is a local maximum!\n\n### Optimizing Flight Control\n\nOur function is $R(t,h)=27800-5t^2-6ht-3h^2+400t+300h$. Our partial derivatives are $$\n\\begin{array}{rcl}\nf_t(t,h) &=& -10t - 6h + 400 \\\\\nf_h(t,h) &=& -6t-6h+300\n\\end{array}\n$$ Setting both to zero, $$\n\\begin{array}{rcl}\n -10t - 6h + 400 &=& 0\\\\\n -6t-6h+300 &=& 0\n\\end{array}\n$$ we subtract the second from the first to find that $-4t+100 = 0$ and so $t=25$. This means that $-250 - 6h +400 = 0$ which becomes $6h = 150$ and therefore $h = 25$. So the optimal conditions are $t=25$ and $h=25$.\n\nLet's check to see what type of critical point this is.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nf=makeFun(27800-5*t^2-6*h*t-3*h^2+400*t+300*h ~ t&h)\na=25\nb=25\nr = 0.1\ntheta = seq(0,2*pi,pi/10)\nf(a,b) - f(a+r*cos(theta), b+r*sin(theta)) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] 0.050000000 0.065723728 0.071621865 0.065441526 0.049543388 0.030000000\n [7] 0.014276272 0.008378135 0.014558474 0.030456612 0.050000000 0.065723728\n[13] 0.071621865 0.065441526 0.049543388 0.030000000 0.014276272 0.008378135\n[19] 0.014558474 0.030456612 0.050000000\n```\n\n\n:::\n:::\n\n\n\nThis is a local maximum.\n</details>\n\n\n\n\n",
    "supporting": [
      "4B-Optimization2D_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}